{"ast":null,"code":"import canUseDom from '../../../utils/canUseDom';\nimport isDocumentVisible from './isDocumentVisible';\nvar listeners = [];\n\nfunction subscribe(listener) {\n  listeners.push(listener);\n  return function unsubscribe() {\n    var index = listeners.indexOf(listener);\n    listeners.splice(index, 1);\n  };\n}\n\nif (canUseDom()) {\n  var revalidate = function revalidate() {\n    if (!isDocumentVisible()) return;\n\n    for (var i = 0; i < listeners.length; i++) {\n      var listener = listeners[i];\n      listener();\n    }\n  };\n\n  window.addEventListener('visibilitychange', revalidate, false);\n}\n\nexport default subscribe;","map":{"version":3,"sources":["E:/wcy/Github/fun-rec/codes/news_recsys/news_rec_web/my-app-ts/node_modules/ahooks/es/useRequest/src/utils/subscribeReVisible.js"],"names":["canUseDom","isDocumentVisible","listeners","subscribe","listener","push","unsubscribe","index","indexOf","splice","revalidate","i","length","window","addEventListener"],"mappings":"AAAA,OAAOA,SAAP,MAAsB,0BAAtB;AACA,OAAOC,iBAAP,MAA8B,qBAA9B;AACA,IAAIC,SAAS,GAAG,EAAhB;;AAEA,SAASC,SAAT,CAAmBC,QAAnB,EAA6B;AAC3BF,EAAAA,SAAS,CAACG,IAAV,CAAeD,QAAf;AACA,SAAO,SAASE,WAAT,GAAuB;AAC5B,QAAIC,KAAK,GAAGL,SAAS,CAACM,OAAV,CAAkBJ,QAAlB,CAAZ;AACAF,IAAAA,SAAS,CAACO,MAAV,CAAiBF,KAAjB,EAAwB,CAAxB;AACD,GAHD;AAID;;AAED,IAAIP,SAAS,EAAb,EAAiB;AACf,MAAIU,UAAU,GAAG,SAASA,UAAT,GAAsB;AACrC,QAAI,CAACT,iBAAiB,EAAtB,EAA0B;;AAE1B,SAAK,IAAIU,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGT,SAAS,CAACU,MAA9B,EAAsCD,CAAC,EAAvC,EAA2C;AACzC,UAAIP,QAAQ,GAAGF,SAAS,CAACS,CAAD,CAAxB;AACAP,MAAAA,QAAQ;AACT;AACF,GAPD;;AASAS,EAAAA,MAAM,CAACC,gBAAP,CAAwB,kBAAxB,EAA4CJ,UAA5C,EAAwD,KAAxD;AACD;;AAED,eAAeP,SAAf","sourcesContent":["import canUseDom from '../../../utils/canUseDom';\nimport isDocumentVisible from './isDocumentVisible';\nvar listeners = [];\n\nfunction subscribe(listener) {\n  listeners.push(listener);\n  return function unsubscribe() {\n    var index = listeners.indexOf(listener);\n    listeners.splice(index, 1);\n  };\n}\n\nif (canUseDom()) {\n  var revalidate = function revalidate() {\n    if (!isDocumentVisible()) return;\n\n    for (var i = 0; i < listeners.length; i++) {\n      var listener = listeners[i];\n      listener();\n    }\n  };\n\n  window.addEventListener('visibilitychange', revalidate, false);\n}\n\nexport default subscribe;"]},"metadata":{},"sourceType":"module"}