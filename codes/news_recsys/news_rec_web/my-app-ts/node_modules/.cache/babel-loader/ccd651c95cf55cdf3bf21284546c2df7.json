{"ast":null,"code":"import { useEffect, useRef } from 'react';\nimport useUnmount from '../../../useUnmount';\nimport limit from '../utils/limit';\nimport subscribeFocus from '../utils/subscribeFocus';\n\nvar useRefreshOnWindowFocusPlugin = function useRefreshOnWindowFocusPlugin(fetchInstance, _a) {\n  var refreshOnWindowFocus = _a.refreshOnWindowFocus,\n      _b = _a.focusTimespan,\n      focusTimespan = _b === void 0 ? 5000 : _b;\n  var unsubscribeRef = useRef();\n\n  var stopSubscribe = function stopSubscribe() {\n    var _a;\n\n    (_a = unsubscribeRef.current) === null || _a === void 0 ? void 0 : _a.call(unsubscribeRef);\n  };\n\n  useEffect(function () {\n    if (refreshOnWindowFocus) {\n      var limitRefresh_1 = limit(fetchInstance.refresh.bind(fetchInstance), focusTimespan);\n      unsubscribeRef.current = subscribeFocus(function () {\n        limitRefresh_1();\n      });\n    }\n\n    return function () {\n      stopSubscribe();\n    };\n  }, [refreshOnWindowFocus, focusTimespan]);\n  useUnmount(function () {\n    stopSubscribe();\n  });\n  return {};\n};\n\nexport default useRefreshOnWindowFocusPlugin;","map":{"version":3,"sources":["E:/wcy/Github/fun-rec/codes/news_recsys/news_rec_web/my-app-ts/node_modules/ahooks/es/useRequest/src/plugins/useRefreshOnWindowFocusPlugin.js"],"names":["useEffect","useRef","useUnmount","limit","subscribeFocus","useRefreshOnWindowFocusPlugin","fetchInstance","_a","refreshOnWindowFocus","_b","focusTimespan","unsubscribeRef","stopSubscribe","current","call","limitRefresh_1","refresh","bind"],"mappings":"AAAA,SAASA,SAAT,EAAoBC,MAApB,QAAkC,OAAlC;AACA,OAAOC,UAAP,MAAuB,qBAAvB;AACA,OAAOC,KAAP,MAAkB,gBAAlB;AACA,OAAOC,cAAP,MAA2B,yBAA3B;;AAEA,IAAIC,6BAA6B,GAAG,SAASA,6BAAT,CAAuCC,aAAvC,EAAsDC,EAAtD,EAA0D;AAC5F,MAAIC,oBAAoB,GAAGD,EAAE,CAACC,oBAA9B;AAAA,MACIC,EAAE,GAAGF,EAAE,CAACG,aADZ;AAAA,MAEIA,aAAa,GAAGD,EAAE,KAAK,KAAK,CAAZ,GAAgB,IAAhB,GAAuBA,EAF3C;AAGA,MAAIE,cAAc,GAAGV,MAAM,EAA3B;;AAEA,MAAIW,aAAa,GAAG,SAASA,aAAT,GAAyB;AAC3C,QAAIL,EAAJ;;AAEA,KAACA,EAAE,GAAGI,cAAc,CAACE,OAArB,MAAkC,IAAlC,IAA0CN,EAAE,KAAK,KAAK,CAAtD,GAA0D,KAAK,CAA/D,GAAmEA,EAAE,CAACO,IAAH,CAAQH,cAAR,CAAnE;AACD,GAJD;;AAMAX,EAAAA,SAAS,CAAC,YAAY;AACpB,QAAIQ,oBAAJ,EAA0B;AACxB,UAAIO,cAAc,GAAGZ,KAAK,CAACG,aAAa,CAACU,OAAd,CAAsBC,IAAtB,CAA2BX,aAA3B,CAAD,EAA4CI,aAA5C,CAA1B;AACAC,MAAAA,cAAc,CAACE,OAAf,GAAyBT,cAAc,CAAC,YAAY;AAClDW,QAAAA,cAAc;AACf,OAFsC,CAAvC;AAGD;;AAED,WAAO,YAAY;AACjBH,MAAAA,aAAa;AACd,KAFD;AAGD,GAXQ,EAWN,CAACJ,oBAAD,EAAuBE,aAAvB,CAXM,CAAT;AAYAR,EAAAA,UAAU,CAAC,YAAY;AACrBU,IAAAA,aAAa;AACd,GAFS,CAAV;AAGA,SAAO,EAAP;AACD,CA5BD;;AA8BA,eAAeP,6BAAf","sourcesContent":["import { useEffect, useRef } from 'react';\nimport useUnmount from '../../../useUnmount';\nimport limit from '../utils/limit';\nimport subscribeFocus from '../utils/subscribeFocus';\n\nvar useRefreshOnWindowFocusPlugin = function useRefreshOnWindowFocusPlugin(fetchInstance, _a) {\n  var refreshOnWindowFocus = _a.refreshOnWindowFocus,\n      _b = _a.focusTimespan,\n      focusTimespan = _b === void 0 ? 5000 : _b;\n  var unsubscribeRef = useRef();\n\n  var stopSubscribe = function stopSubscribe() {\n    var _a;\n\n    (_a = unsubscribeRef.current) === null || _a === void 0 ? void 0 : _a.call(unsubscribeRef);\n  };\n\n  useEffect(function () {\n    if (refreshOnWindowFocus) {\n      var limitRefresh_1 = limit(fetchInstance.refresh.bind(fetchInstance), focusTimespan);\n      unsubscribeRef.current = subscribeFocus(function () {\n        limitRefresh_1();\n      });\n    }\n\n    return function () {\n      stopSubscribe();\n    };\n  }, [refreshOnWindowFocus, focusTimespan]);\n  useUnmount(function () {\n    stopSubscribe();\n  });\n  return {};\n};\n\nexport default useRefreshOnWindowFocusPlugin;"]},"metadata":{},"sourceType":"module"}